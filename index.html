<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="utf-8">
<title>Powerpoint-Präsentation → HTML-Präsentation (OPAL)</title>

<style>
body {
  font-family: Arial, sans-serif;
  background: #f4f4f4;
  margin: 0;
  padding: 30px;
  line-height: 1.4;
}
.box {
  background: white;
  padding: 20px;
  border-radius: 8px;
  max-width: 760px;
  margin: auto;
}
button {
  padding: 10px 18px;
  font-size: 16px;
  cursor: pointer;
  margin-top: 10px;
}
#downloadBtn { display:none; }
#status { margin-top:15px; }
small { color:#666; }
</style>
</head>

<body>

<div class="box">
  <h1>📂 PowerPoint → HTML-Präsentation</h1>

  <p>
    In OPAL lassen sich PowerPoint-Präsentationen nicht direkt präsentieren. pdf-Export ist keine wirkliche Alternative zur Präsentation. Dadurch entsteht häufig ein Medienbruch:<br>
    Die Präsentation muss außerhalb von OPAL in einem anderen Programm geöffnet werden.<br>
    Dieses Tool ermöglicht es, Präsentationen als HTML im Browser darzustellen, sodass sie innerhalb von OPAL genutzt werden können, ohne PowerPoint oder zusätzliche Software zu starten. <br>
    Die Präsentation kann im Vollbild dargestellt werden und ist mit den Pfeiltasten bzw. der Leertaste scrollbar. Außerdem gibt es einen Präsentationsmodus.
  </p>

  <p> 
    Vorgehen:<br>
    1. Öffnen Sie die Präsentation, die Sie umwandeln möchten in Powerpoint oder einem andern Presenter-Programm (z.B. Libre Office). <br>
    2. Speichern Sie alle Folien als .PNG oder .jpg in einen Ordner. Sie erzeugen aus den Einzelfolien eine Bilderfolge. <br>
  </p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/zfrGiasKysY?si=Lq5xX_8rdgdKJDS9" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
  <p/p>
    3. Klicken Sie auf den Button "Folienordner auswählen". <br>
    4. Wählen Sie den entsprechen Ordner aus und klicken Sie auf den Button "Hochladen". Ihre Bilder werden nicht dauerhaft gespeichert. <br>
    5. Klicken Sie auf den Button "HTML vorbereiten". Die html-Datei wird erstellt. <br>
    6. Klicken Sie auf den den Button "HTML herunterladen". Die html wird in Ihren Downloadordner heruntergeladen. <br>
    7. Erstellen Sie in OPAL in Ihrem Kurs den Kursbaustein "Einzelne Seite". <br>
    8. Klicken Sie auf den Reiter "Seiteninhalt" und dann auf den Button "Seite auswählen oder erstellen".<br>
    9. Klicken Sie im Abschnitt "Inhalt hochladen"" auf "Datei auswählen" und wählen die heruntergeladene html. <br>
    10. Klicken Sie auf den Button "Hochladen". <br>
    11. Publizieren Sie Ihren Kurs, um die Änderungen zu veröffentlichen. <br>
  </p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/Azvk18PLV9E?si=5aHR4tnHj3ykrVH9" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
  
  <input type="file" id="files" webkitdirectory multiple accept="image/*" hidden>
    <button onclick="document.getElementById('files').click()">
        📂 Folienordner auswählen
    </button>


  <button onclick="prepare()">HTML vorbereiten</button>
  <button id="downloadBtn" onclick="downloadHtml()">HTML herunterladen</button>

  <p id="status"></p>

  <p> Hinweis: Der Präsentationsmodus öffnet ein separates Fenster im Browser. Die OPAL-Darstellung wird nun zur Beameransicht, während das neue Fenster die Ansicht für den Präsentator darstellt. Wird die Folie in der Präsentator-Ansicht gewechselt, so wechselt auch die Folie in der Beameransicht.</p>

  <hr>
</div>

<script>
let generatedHtml = "";

function prepare() {
  const files = Array.from(document.getElementById("files").files)
    .filter(f => f.type.startsWith("image/"))
    .sort((a,b)=>a.name.localeCompare(b.name,undefined,{numeric:true}));

  if(!files.length){ alert("Bitte Bilder auswählen."); return; }

  document.getElementById("status").textContent =
    files.length + " Bilder geladen – HTML wird erzeugt…";

  Promise.all(files.map(toBase64)).then(images=>{
    const slides = images.map(src =>
      `<div class="slide"><img src="${src}"></div>`
    ).join("");

    const nums = images.map((_,i)=>
      `<span class="num" data-i="${i}">${i+1}</span>`
    ).join("");

    generatedHtml = presentationTemplate
      .replace("__SLIDES__", slides)
      .replace("__NUMS__", nums);

    document.getElementById("downloadBtn").style.display="inline-block";
    document.getElementById("status").textContent="HTML bereit.";
  });
}

function toBase64(file){
  return new Promise(res=>{
    const r=new FileReader();
    r.onload=()=>res(r.result);
    r.readAsDataURL(file);
  });
}

function downloadHtml(){
  const blob=new Blob([generatedHtml],{type:"text/html"});
  const a=document.createElement("a");
  a.href=URL.createObjectURL(blob);
  a.download="index.html";
  a.click();
}

const presentationTemplate = `<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Präsentation</title>

<style>
html,body{margin:0;width:100%;height:100%;background:#000;overflow:hidden;}
.slide{display:none;width:100vw;height:100vh;align-items:center;justify-content:center;}
.slide.active{display:flex;}
.slide img{max-width:100vw;max-height:100vh;object-fit:contain;}

:fullscreen .slide img{width:100vw;height:100vh;object-fit:cover;}

#progress{position:fixed;bottom:0;left:0;width:100%;height:6px;background:rgba(255,255,255,.2);}
#bar{height:100%;width:0;background:#4da3ff;}

#nums{position:fixed;bottom:12px;width:100%;text-align:center;}
.num{color:#aaa;margin:0 6px;cursor:pointer;}
.num.active{color:#4da3ff;font-weight:bold;}

#hint{position:fixed;bottom:40px;width:100%;text-align:center;color:#bbb;font-family:Arial;font-size:14px;}

body.presenter #beamer{display:none;}
body.presenter #presenter{display:grid;}

#presenter{
  display:none;position:fixed;inset:0;
  grid-template-columns:1.2fr 1fr;
  grid-template-rows:1fr auto;
  gap:12px;padding:12px;
}
.panel{background:rgba(255,255,255,.08);border-radius:10px;overflow:hidden;}
.panel h3{margin:0;padding:8px;font-size:13px;background:rgba(0,0,0,.4);color:#fff;}
.panel img{width:100%;height:100%;object-fit:contain;}
#status{grid-column:1/3;color:#ccc;font-size:13px;display:flex;justify-content:space-between;}
</style>
</head>

<body class="normal">

<div id="beamer">__SLIDES__</div>

<div id="presenter">
  <div class="panel"><h3>Aktuelle Folie</h3><img id="p-cur"></div>
  <div class="panel"><h3>Nächste Folie</h3><img id="p-next"></div>
  <div id="status">
    <span id="meta"></span>
    <span>← → Leertaste · F Vollbild · Fenster schließen = Ende</span>
  </div>
</div>

<div id="progress"><div id="bar"></div></div>
<div id="nums">__NUMS__</div>
<div id="hint">← → Leertaste · P Präsentationsmodus · F Vollbild</div>

<script>
const slides=[...document.querySelectorAll('.slide')];
const imgs=slides.map(s=>s.querySelector('img'));
const nums=[...document.querySelectorAll('.num')];
const bar=document.getElementById('bar');
const pCur=document.getElementById('p-cur');
const pNext=document.getElementById('p-next');
const meta=document.getElementById('meta');

let index=0;
let mode='normal';
const KEY='offline_presentation_sync';

function render(){
  slides.forEach(s=>s.classList.remove('active'));
  slides[index].classList.add('active');

  bar.style.width=((index+1)/slides.length*100)+'%';
  nums.forEach(n=>n.classList.remove('active'));
  nums[index].classList.add('active');

  if(mode==='presenter'){
    pCur.src=imgs[index].src;
    pNext.src=imgs[index+1]?imgs[index+1].src:'';
    meta.textContent='Folie '+(index+1)+' / '+slides.length;
  }
}

function setIndex(i){
  index=Math.max(0,Math.min(i,slides.length-1));
  localStorage.setItem(KEY,index);
  render();
}

window.addEventListener('storage',e=>{
  if(e.key===KEY && mode==='beamer'){
    index=parseInt(e.newValue||0);
    render();
  }
});

document.addEventListener('keydown',e=>{
  if(e.key==='f'||e.key==='F'){
    document.fullscreenElement?document.exitFullscreen():document.documentElement.requestFullscreen();
    return;
  }
  if((e.key==='p'||e.key==='P')&&mode==='normal'){start();return;}
  if(mode==='beamer')return;
  if(e.key==='ArrowRight'||e.key===' ')setIndex(index+1);
  if(e.key==='ArrowLeft')setIndex(index-1);
});

nums.forEach(n=>n.onclick=()=>{if(mode!=='beamer')setIndex(+n.dataset.i);});

function start(){
  const w=window.open(location.pathname+'?presenter=1','presenter');
  if(!w){alert('Popup blockiert');return;}
  mode='beamer';
  document.body.className='beamer';
  document.getElementById('hint').textContent='Beameransicht – Steuerung im Vortragendenfenster';
}

if(location.search.includes('presenter')){
  mode='presenter';
  document.body.className='presenter';
}

index=parseInt(localStorage.getItem(KEY)||0);
render();
<\/script>

</body>
</html>`;
</script>

</body>
</html>





